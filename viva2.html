<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Tracker App - Additional Questions</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #3498db;
            margin-top: 30px;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        code {
            font-family: Consolas, monospace;
        }
        .question {
            font-weight: bold;
            color: #2c3e50;
            margin-top: 20px;
        }
        .answer {
            margin-left: 20px;
        }
    </style>
</head>
<body>

<h1>Personal Finance Tracker App - Additional Code Examples</h1>

<h2>Transaction List Implementation</h2>

<div class="question">1. How are you showing all transaction lists? Where is the code?</div>
<div class="answer">
    <p>The transaction list is implemented in <code>TransactionListActivity.kt</code> using RecyclerView with a custom adapter:</p>
    <pre><code>// TransactionListActivity.kt
class TransactionListActivity : AppCompatActivity() {

    private lateinit var transactionRecycler: RecyclerView
    private lateinit var transactionList: MutableList<Transaction>
    private lateinit var adapter: TransactionAdapter

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_transaction_list)

        transactionRecycler = findViewById(R.id.recyclerTransactions)
        transactionRecycler.layoutManager = LinearLayoutManager(this)

        transactionList = loadTransactions()

        adapter = TransactionAdapter(transactionList)
        transactionRecycler.adapter = adapter
    }

    override fun onResume() {
        super.onResume()
        reloadTransactions()
    }

    private fun reloadTransactions() {
        val sharedPref = getSharedPreferences("FinancePrefs", Context.MODE_PRIVATE)
        val json = sharedPref.getString("transactions", null)
        val type = object : TypeToken<MutableList<Transaction>>() {}.type

        val updatedList: MutableList<Transaction> = if (json != null) {
            Gson().fromJson(json, type)
        } else {
            mutableListOf()
        }

        transactionList.clear()
        transactionList.addAll(updatedList)
        adapter.notifyDataSetChanged()
    }

    private fun loadTransactions(): MutableList<Transaction> {
        val sharedPref = getSharedPreferences("FinancePrefs", Context.MODE_PRIVATE)
        val json = sharedPref.getString("transactions", null)
        return if (json != null) {
            val type = object : TypeToken<MutableList<Transaction>>() {}.type
            Gson().fromJson(json, type)
        } else {
            mutableListOf()
        }
    }
}</code></pre>

    <p>And the adapter implementation in <code>TransactionAdapter.kt</code>:</p>
    <pre><code>// TransactionAdapter.kt
class TransactionAdapter(private val transactions: List<Transaction>) : 
    RecyclerView.Adapter<TransactionAdapter.ViewHolder>() {

    class ViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val tvTitle: TextView = view.findViewById(R.id.tvTransactionTitle)
        val tvAmount: TextView = view.findViewById(R.id.tvTransactionAmount)
        val tvCategory: TextView = view.findViewById(R.id.tvTransactionCategory)
        val tvDate: TextView = view.findViewById(R.id.tvTransactionDate)
    }

    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ViewHolder {
        val view = LayoutInflater.from(parent.context)
            .inflate(R.layout.item_transaction, parent, false)
        return ViewHolder(view)
    }

    override fun onBindViewHolder(holder: ViewHolder, position: Int) {
        val transaction = transactions[position]
        holder.tvTitle.text = transaction.title
        holder.tvAmount.text = "$${transaction.amount}"
        holder.tvCategory.text = transaction.category
        holder.tvDate.text = transaction.date
        
        holder.itemView.setOnClickListener {
            val context = holder.itemView.context
            val intent = Intent(context, TransactionActivity::class.java)
            
            val gson = Gson()
            intent.putExtra("editTransaction", gson.toJson(transaction))
            intent.putExtra("position", position)
            
            context.startActivity(intent)
        }
    }

    override fun getItemCount() = transactions.size
}</code></pre>
</div>

<h2>Budget Reset Functionality</h2>

<div class="question">2. Where is the function for resetting the budget?</div>
<div class="answer">
    <p>The budget reset functionality is implemented in <code>BudgetActivity.kt</code> with a reset button:</p>
    <pre><code>// BudgetActivity.kt
class BudgetActivity : AppCompatActivity() {
    
    private lateinit var btnReset: Button
    // ...other variables

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_budget)

        // ...other initializations
        btnReset = findViewById(R.id.btnResetBudget)
        
        // ...other code

        // Budget Reset Button Implementation
        btnReset.setOnClickListener {
            val prefs = getSharedPreferences("FinancePrefs", Context.MODE_PRIVATE)
            prefs.edit().remove("budget").apply()
            budget = 0f
            updateUI()
            Toast.makeText(this, "Budget has been reset", Toast.LENGTH_SHORT).show()
        }
    }
    
    // ...other methods
}</code></pre>
    <p>This function completely removes the budget value from SharedPreferences, effectively resetting it to zero.</p>
</div>

<h2>Budget Notifications in MainActivity</h2>

<div class="question">3. How are budget notifications shown in MainActivity?</div>
<div class="answer">
    <p>Budget notifications are displayed in <code>MainActivity.kt</code> through a warning TextView that is updated when the app checks the budget status:</p>
    <pre><code>// MainActivity.kt
class MainActivity : AppCompatActivity() {

    private lateinit var tvBudgetWarning: TextView
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        
        tvBudgetWarning = findViewById(R.id.tvBudgetWarning)
        
        // Other initializations...
    }
    
    override fun onResume() {
        super.onResume()
        checkBudgetStatus() // Update budget warning whenever MainActivity is resumed
    }
    
    private fun checkBudgetStatus() {
        val prefs = getSharedPreferences("FinancePrefs", Context.MODE_PRIVATE)
        val budget = prefs.getFloat("budget", 0f)
        
        if (budget == 0f) {
            tvBudgetWarning.text = "⚠️ No budget set! Tap 'Budget' to set one."
            tvBudgetWarning.visibility = View.VISIBLE
            return
        }
        
        // Calculate total spending
        val json = prefs.getString("transactions", null)
        val type = object : TypeToken<List<Transaction>>() {}.type
        val transactions: List<Transaction> = if (json != null) {
            Gson().fromJson(json, type)
        } else {
            emptyList()
        }
        
        val totalSpent = transactions.sumOf { it.amount }.toFloat()
        val percentageUsed = if (budget > 0) (totalSpent / budget) * 100 else 0f
        
        // Set appropriate warning based on budget usage
        tvBudgetWarning.text = when {
            percentageUsed > 100 -> "❌ You have exceeded your budget!"
            percentageUsed > 80 -> "⚠️ You're close to exceeding your budget!"
            else -> ""
        }
        
        tvBudgetWarning.visibility = if (tvBudgetWarning.text.isNotEmpty()) 
            View.VISIBLE else View.GONE
    }
    
    // Other methods...
}</code></pre>
    <p>This code checks the current budget and total spending, then displays appropriate warning messages based on the percentage of budget used.</p>
</div>

<h2>Android's Notification Manager Implementation</h2>

<div class="question">4. Where is the code that allows Android's Notification Manager to give notifications from the app?</div>
<div class="answer">
    <p>Notifications are implemented in two key files:</p>
    
    <p><strong>1. NotificationHelper.kt</strong> - Creates notification channels (required for Android 8.0+):</p>
    <pre><code>// NotificationHelper.kt
package com.example.personalfinancetrackerapp.utils

import android.app.NotificationChannel
import android.app.NotificationManager
import android.content.Context
import android.os.Build
import androidx.core.app.NotificationCompat
import androidx.core.app.NotificationManagerCompat
import com.example.personalfinancetrackerapp.R

object NotificationHelper {

    const val CHANNEL_ID = "budget_alerts"
    
    fun createNotificationChannel(context: Context) {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
            val name = "Budget Alerts"
            val descriptionText = "Daily reminders for budget tracking"
            val importance = NotificationManager.IMPORTANCE_HIGH
            val channel = NotificationChannel(CHANNEL_ID, name, importance).apply {
                description = descriptionText
                enableVibration(true)
                enableLights(true)
            }
            
            val notificationManager = context.getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager
            notificationManager.createNotificationChannel(channel)
        }
    }
    
    fun showNotification(context: Context, title: String, message: String) {
        val builder = NotificationCompat.Builder(context, CHANNEL_ID)
            .setSmallIcon(R.mipmap.logo9715)
            .setContentTitle(title)
            .setContentText(message)
            .setPriority(NotificationCompat.PRIORITY_HIGH)
            .setAutoCancel(true)
            .setVisibility(NotificationCompat.VISIBILITY_PUBLIC)
        
        with(NotificationManagerCompat.from(context)) {
            // Check permission for Android 13+
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
                if (context.checkSelfPermission(android.Manifest.permission.POST_NOTIFICATIONS) == 
                    android.content.pm.PackageManager.PERMISSION_GRANTED) {
                    notify(1001, builder.build())
                }
            } else {
                notify(1001, builder.build())
            }
        }
    }
}</code></pre>

    <p><strong>2. ReminderReceiver.kt</strong> - Broadcasts notifications when triggered by the Alarm Manager:</p>
    <pre><code>// ReminderReceiver.kt
package com.example.personalfinancetrackerapp

import android.Manifest
import android.content.BroadcastReceiver
import android.content.Context
import android.content.Intent
import android.content.pm.PackageManager
import android.os.Build
import androidx.core.app.ActivityCompat
import androidx.core.app.NotificationCompat
import androidx.core.app.NotificationManagerCompat
import com.example.personalfinancetrackerapp.utils.NotificationHelper

class ReminderReceiver : BroadcastReceiver() {
    override fun onReceive(context: Context, intent: Intent) {
        // Ensure notification channel exists
        NotificationHelper.createNotificationChannel(context)

        val builder = NotificationCompat.Builder(context, NotificationHelper.CHANNEL_ID)
            .setSmallIcon(R.mipmap.logo9715)
            .setContentTitle("🕗 Daily Reminder")
            .setContentText("Don't forget to record your expenses today!")
            .setPriority(NotificationCompat.PRIORITY_HIGH)
            .setAutoCancel(true)
            .setVisibility(NotificationCompat.VISIBILITY_PUBLIC)

        val notificationManager = NotificationManagerCompat.from(context)
        
        // Check notification permission for Android 13+
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
            if (ActivityCompat.checkSelfPermission(context, Manifest.permission.POST_NOTIFICATIONS) == 
                PackageManager.PERMISSION_GRANTED) {
                notificationManager.notify(1002, builder.build())
            }
        } else {
            // For older Android versions, no need to check permission
            notificationManager.notify(1002, builder.build())
        }
    }
}</code></pre>
</div>

<h2>Expense Summary by Category</h2>

<div class="question">5. How do you get a summary of expenses per category? Please show the code.</div>
<div class="answer">
    <p>The summary of expenses per category is implemented in <code>CategoryChartActivity.kt</code> for visualization in a pie chart:</p>
    <pre><code>// CategoryChartActivity.kt
class CategoryChartActivity : AppCompatActivity() {

    private lateinit var pieChart: PieChart

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_category_chart)

        pieChart = findViewById(R.id.pieChart)

        val transactions = loadTransactions()
        val categoryTotals = calculateTotals(transactions)

        setupPieChart(categoryTotals)
    }

    // Load all transactions from SharedPreferences
    private fun loadTransactions(): List<Transaction> {
        val prefs = getSharedPreferences("FinancePrefs", Context.MODE_PRIVATE)
        val json = prefs.getString("transactions", null)
        val type = object : TypeToken<List<Transaction>>() {}.type
        return if (json != null) Gson().fromJson(json, type) else emptyList()
    }

    // Calculate total amount spent per category
    private fun calculateTotals(transactions: List<Transaction>): Map<String, Float> {
        val categoryMap = mutableMapOf<String, Float>()

        for (t in transactions) {
            val current = categoryMap[t.category] ?: 0f
            categoryMap[t.category] = current + t.amount.toFloat()
        }

        return categoryMap
    }

    // Set up the pie chart with the calculated category totals
    private fun setupPieChart(categoryTotals: Map<String, Float>) {
        val entries = ArrayList<PieEntry>()
        for ((category, amount) in categoryTotals) {
            entries.add(PieEntry(amount, category))
        }

        val dataSet = PieDataSet(entries, "Category-wise Spending")
        dataSet.colors = ColorTemplate.MATERIAL_COLORS.toList()
        dataSet.valueTextColor = Color.BLACK
        dataSet.valueTextSize = 14f

        val data = PieData(dataSet)

        pieChart.data = data
        pieChart.description.isEnabled = false
        pieChart.centerText = "Spending by Category"
        pieChart.setEntryLabelColor(Color.BLACK)
        pieChart.animateY(1000)
        pieChart.invalidate()
    }
}</code></pre>
    <p>The key part is the <code>calculateTotals()</code> method, which groups transactions by category and sums up the amounts for each category. This is then used to create a pie chart visualization showing the distribution of expenses across different categories.</p>
</div>

<h2>Data Import/Export Implementation</h2>

<div class="question">6. How is the data backup and restore functionality implemented?</div>
<div class="answer">
    <p>The data backup (export) and restore (import) functionality is implemented in <code>MainActivity.kt</code>:</p>
    <pre><code>// MainActivity.kt - Export function
private fun exportData() {
    try {
        val sharedPref = getSharedPreferences("FinancePrefs", Context.MODE_PRIVATE)
        val json = sharedPref.getString("transactions", null)
        
        if (json == null || json.isEmpty()) {
            Toast.makeText(this, "No data to export", Toast.LENGTH_SHORT).show()
            return
        }
        
        val fileName = "finance_backup_${SimpleDateFormat("yyyyMMdd", Locale.getDefault()).format(Date())}.json"
        
        // Write to internal storage
        openFileOutput(fileName, Context.MODE_PRIVATE).use {
            it.write(json.toByteArray())
        }
        
        Toast.makeText(this, "Data exported to $fileName", Toast.LENGTH_LONG).show()
        
    } catch (e: Exception) {
        Toast.makeText(this, "Export failed: ${e.message}", Toast.LENGTH_SHORT).show()
    }
}</code></pre>

    <pre><code>// MainActivity.kt - Import function
private fun importData() {
    try {
        // Show file picker dialog for backup files
        val files = filesDir.listFiles { file -> file.name.endsWith(".json") }
        
        if (files == null || files.isEmpty()) {
            Toast.makeText(this, "No backup files found", Toast.LENGTH_SHORT).show()
            return
        }
        
        val fileNames = files.map { it.name }.toTypedArray()
        
        AlertDialog.Builder(this)
            .setTitle("Select Backup File")
            .setItems(fileNames) { _, which ->
                try {
                    val selectedFile = files[which]
                    
                    // Read the JSON from the file
                    val json = selectedFile.readText()
                    
                    // Validate JSON structure
                    val type = object : TypeToken<List<Transaction>>() {}.type
                    Gson().fromJson<List<Transaction>>(json, type) // Throws if invalid
                    
                    // Store in SharedPreferences
                    getSharedPreferences("FinancePrefs", Context.MODE_PRIVATE)
                        .edit()
                        .putString("transactions", json)
                        .apply()
                    
                    Toast.makeText(this, "Data imported successfully", Toast.LENGTH_SHORT).show()
                    
                } catch (e: Exception) {
                    Toast.makeText(this, "Import failed: ${e.message}", Toast.LENGTH_SHORT).show()
                }
            }
            .setNegativeButton("Cancel", null)
            .show()
        
    } catch (e: Exception) {
        Toast.makeText(this, "Import failed: ${e.message}", Toast.LENGTH_SHORT).show()
    }
}</code></pre>
    <p>The export function saves transaction data as a JSON file in the app's internal storage, while the import function reads JSON data from a selected backup file and restores it to SharedPreferences.</p>
</div>

</body>
</html>